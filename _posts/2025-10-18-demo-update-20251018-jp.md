---
title: "《リリーファンタジア》 / デモアップデート 2025-10-18"
date: 2025-10-18 16:00:00 +0800
author: null_id
categories: []
tag: [lilyfantasia]
media_subpath: /assets/posts/demo-update-2025-10-18/
CJKmainfont: Hiragino Sans GB
---

## はじめに
前置きはありません。さっそく本題に入りましょう。

## 入力ディスプレイ
ずっとこの機能を実装したいと思っていました。プレイヤーが使用しているデバイスの入力が、ステージの隅に小さく表示されるようになります。

![input display demo](ingame_input_display_concept.png)

このディスプレイを設ける目的は2つあります。  
まず1つ目は、チュートリアルでキーの位置を分かりやすくするためです。  
2つ目は、プレイヤーが外部ツール（例えばOBSプラグインなど）を使わずに、内蔵機能でプレイ映像を録画できるようにするためです。

少し時間はかかりましたが（テクスチャ制作も含めて）、実装が完了しました。

{% include embed/video.html src='ingame_input_display.mp4' %}

動画ではキーボードを使用していますが、Switch Proコントローラー、PS5 DualSenseコントローラー、Xbox Seriesコントローラーなど、主要なゲームパッドにも対応しています。

## 実績システム
はい、ついにゲーム内実績が実装されました。  
実績の種類はいくつかありますが、もちろんメインは「特定の楽曲をクリアすること」です。

### 実績通知
実績解除時に表示される通知演出にも、かなり時間をかけました。

{% include embed/video.html src='achievement_flush.mp4' %}

これまで作ったアニメーションの中でも、個人的に一番気に入っているかもしれません。スタンプのアニメーションと効果音がとても気持ちよく仕上がっています。

### ローディング画面のトランジション更新
同じ動画内で、ローディング画面のトランジションも更新されています。  
以前は紙がフェードインするだけでしたが、現在は2枚の紙が画面を覆うようなアニメーションになっています。  
紙の質感を活かしたデザインにしているので、今後も「現実的に起こり得る」ような演出を意識して追加していく予定です。

### プロフィール画像と実績メニュー
以前から、実績システムをプロフィール画像システムと統合する予定でした。  
解除した実績のアイコンをプロフィール画像として設定できるようになっています。

{% include embed/video.html src='changing_pfp.mp4' %}

動画の最初にあるように、デフォルトのSteamアバターを使用することも可能です。  
また、ゲーム内の名前も「Kenji Hiano」ではなく、Steamのユーザー名がそのまま使用されます。

ゲーム内でSteamのユーザー名を表示できるようになったことで、そもそも独自の名前変更機能を用意する必要があるのかどうか悩んでいます。  
Steam側ではユーザーが任意の文字列を送信する仕組みを提供していないため、そのようなシステムを作るのは難しそうです。

![Profile Picture Menu](profile_picture_menu.png)

また、進行度が必要な実績も存在し、上の画像のように進捗状況を確認できるようになっています。

## ディフレクト・ファーストビート演出
現在、「ディフレクト」シーケンスの最初のビート（＝プレイヤーがディフレクトを始めるタイミング）を知らせるための演出がありますが、正直あまり分かりやすくありません。  
以前から、ARPGのように「外側の円が小さくなり、内側の円に重なる」アニメーションを夢見ていました。

{% include embed/video.html src='new_firstbeat_animation.mp4' %}

ということで、実装しました。  
まだ最終版ではありませんが、現時点でも十分見せられるクオリティになっています。

## まとめ
現在は、Steamの各種機能の実装を進めています。  
特にリーダーボードの実装を優先していますが、[Facepunch](https://wiki.facepunch.com/steamworks/) や [Steamworks.Net](https://steamworks.github.io) のインターフェースが理想的とは言えず、現在はSteamworks.NetをモダンなC#スタイルに合わせるためのラッパークラスを自作しています。  
完成したら、将来Steamworksを扱いたい開発者の参考になるよう、GitHubの公開リポジトリとして共有する予定です。
